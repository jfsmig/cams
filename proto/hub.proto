syntax = "proto3";

option go_package = ".;proto";

package cams.proto;



service Registrar {
  rpc Register(RegisterRequest) returns (RegisterReply) {}
}

service Controller {
  // Stream of commands from the server to the client
  rpc Control(stream ControlReply) returns (stream ControlRequest) {}
}

service StreamPlayer {
  rpc Media(stream MediaFrame) returns (MediaReply) {}
}



message Status {
  uint32 code = 1;
  string status = 2;
}

message RegisterRequest {
  StreamId id = 1;
}

message RegisterReply {
  Status status = 1;
}

message StreamId {
  string user = 1;
  string stream = 2;
}

enum Action {
  UNSET = 0;
  PLAY = 1;
  STOP = 2;
}

message ControlReply {
  StreamId id = 1;
  uint64 seq = 2;
  Banner banner = 3;
  Status status = 4;
}

message Banner {
  string token = 1;
}

message ControlRequest {
  uint64 seq = 2;
  Action action = 3;
}

message MediaFrame {
  bytes payload = 1;
}

message MediaReply {
  StreamId id = 1;
  Status status = 2;
}
